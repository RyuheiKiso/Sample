# 実装プラン

---

## 機能

テーブル管理機能

---

## プラン
### 1. gRPCプロトコル定義
- `docs/04_通信仕様/02_テーブル管理機能.md` のproto例を参考に、`code/backend/core/proto/table.proto` を作成
- サービス：TableService, ColumnService, RowDataService
- 各種リクエスト/レスポンス/エンティティメッセージを定義

【主なファイル】
■新規作成
- code/backend/core/proto/table.proto
■追加・編集
- docs/04_通信仕様/02_テーブル管理機能.md

### 2. Rustサーバ実装
- tonicを用いてgRPCサーバを実装
- サービスごとにhandlerを分割（table, column, row_data）
- DBアクセス層（SQLite）を実装し、CRUD処理を提供
- バリデーション（重複チェック、必須項目チェック等）を実装
- エラー時はgRPCステータスコードで返却

【主なファイル】
■新規作成
- code/backend/src/feature/table/table.rs
- code/backend/src/feature/table/column.rs
- code/backend/src/feature/table/row_data.rs
■追加・編集
- code/backend/src/main.rs
- code/backend/src/data/app.db
- code/backend/build.rs

### 3. DBスキーマ設計・マイグレーション
- テーブル: tables, columns, row_data
- マイグレーションSQLを `docs/03_db/migration/` に配置
- `apply_migrations.bat`/`migrate.sh` で適用

【主なファイル】
■新規作成
- docs/03_db/migration/002_table.sql
- docs/03_db/migration/003_column.sql
- docs/03_db/migration/004_row_data.sql

### 4. フロントエンド実装
- React + TypeScript
- テーブル一覧/作成/編集/削除画面、詳細画面、列・行の追加/編集/削除ダイアログを作成
- gRPC-webクライアントでバックエンドと通信
- 入力時バリデーション（重複チェック含む）

【主なファイル】
■新規作成
- code/frontend/src/features/table/TableList.tsx
- code/frontend/src/features/table/TableDetail.tsx
- code/frontend/src/features/table/TableForm.tsx
- code/frontend/src/features/table/ColumnForm.tsx
- code/frontend/src/features/table/RowForm.tsx
- code/frontend/src/proto/table_pb.ts
- code/frontend/src/proto/table_grpc_pb.ts

### 5. テスト
- バックエンド: 単体テスト・統合テスト（`code/backend/tests/`）
- フロントエンド: ユニットテスト・結合テスト（Jest, React Testing Library）

【主なファイル】
■新規作成
- code/frontend/src/features/table/TableList.test.tsx
■追加・編集
- code/backend/tests/integration_test.rs

### 6. ログ・エラーハンドリング
- バックエンド: ログ出力（`code/backend/log/`）、エラー時の詳細記録
- フロントエンド: ユーザー向けエラーメッセージ表示

【主なファイル】
■新規作成
- code/frontend/src/shared/ErrorMessage.tsx
■追加・編集
- code/backend/log/
- code/backend/src/common/logger.rs

### 7. ドキュメント整備
- API仕様、画面仕様、運用手順を `docs/` 配下に記載・更新

【主なファイル】
■新規作成
- docs/06_実装プラン/02_テーブル管理機能.md
■追加・編集
- docs/04_通信仕様/02_テーブル管理機能.md
- docs/05_設計/02_テーブル管理機能.md